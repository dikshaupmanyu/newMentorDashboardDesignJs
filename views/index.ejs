<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>TradeTips</title>
  <link rel="icon" href="images/favicon.png" type="image/png" sizes="16x16">
  <link rel="stylesheet" type="text/css" href="css/bootstrap1.min.css">
  <link rel="stylesheet" type="text/css" href="css/fontawesome1-all.min.css">
  <link rel="stylesheet" type="text/css" href="css/style1.css">
  <link rel="stylesheet" type="text/css" href="css/responsive1.css">
</head>

<body>

        <!-- Body Flyers Start -->
    <div class="body_flyer body_flyer1">
      <img src="images/body-flyer.png" alt="images">
    </div>
    <div class="body_flyer body_flyer2">
      <img src="images/body-flyer.png" alt="images">
    </div>
    <!-- Body Flyers End -->


    <!-- Login Start -->
    <div class="onboard_wrapper">
      <div class="account_bx login_bx">
        <div class="account_bx_head">
          <a href="#"><img src="images/logo.png" alt="images"></a>
        </div>
        <div class="account_bx_frm">
          <input type="text" class="form-control" id="uname" name="userName" placeholder="Enter Username" required="required">
          <input type="password" class="form-control" id="pswrd" name="password" placeholder="Enter Password" required="required">
          <div class="rmbr_frgt">
            <label>
            <input type="checkbox" name="remember me" required="required">
            Remember Me
            </label>
          </div>
          <button class="btn cmn_btn btn_primary" id="butlogin">Login</button>
          <!-- <div class="account_bx_btm">
            <h4>New to Trade Tips?</h4>
            <a href="signup.html"><button class="btn cmn_btn btn_secondary">Sign up</button></a>
          </div> -->
        </div>
      </div>
    </div>
    <!-- Login End -->

 <script type="text/javascript" src="js/jquery-3.5.1.slim.min.js"></script>
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    <script type="text/javascript" src="js/popper.min.js"></script>
    <script type="text/javascript" src="js/fontawesome-all.min.js"></script>
    <script type="text/javascript" src="js/custom.js"></script>
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    <script type="text/javascript">

   window.history.forward(); 
        function noBack() { 
            window.history.forward(); 
        } 

    window.addEventListener("load", function() {

      var url_string = window.location.href; 
      var urls = new URL(url_string);
      // alert(urls);


         $('#butlogin').on('click', function() {
            //alert("hii");
            var userName = $('#uname').val();
            var password = $('#pswrd').val();
            if(userName!="" && password!="" ){
              $.ajax({
                type: 'POST',
                url: 'https://apis.tradetipsapp.com/api/auth/appSignIn',
                headers: {
                  Authorization: 'Bearer '+ localStorage.getItem("token"),
                  Authorization: 'Bearer '+ sessionStorage.getItem("token")
                },
                data: {
                  type:2,
                  userName: userName,
                  password: password            
                },
                dataType:'json',
                cache:false,
                success: function(data){
                  // alert(dataResult.accessToken);
                  // alert(userName);
                  var datak = JSON.stringify(data); 
                  var dataResult = JSON.parse(datak);        
                  // alert(data.accessToken);  
                  if(dataResult.accessToken){
                  
                    if(userName != "admin"){

                      $("#success").show();
                      $('#success').html('Login Sucessfully !');
                  
                            const tdss = dataResult.accessToken;
                            const tds1 = dataResult.accessTokenStreamIO;
                            const tds2 = dataResult.userName;
                            const tds3 = dataResult.id;
                            const tds4 = dataResult.accessTokenStreamIOWithID;
                            const tds5 = dataResult.email;

                            localStorage.setItem('allTokenData', JSON.stringify({
                                tokendata: tdss,
                                streamtoken: tds1,
                                uname: tds2,
                                uid: tds3,
                                streamdatatoken: tds4,
                                email:tds5,
                            }));

                       // window.location.href = "/home";  
                       window.location.href = "/dashboard";  

                    }else{

                      alert('Invalid Username or Password !!!');
                      window.location.href = "/"; 
                    }                     
                  }
                  else if(dataResult.statusCode==201){
                    // alert("false");
                    $("#error").show();
                    $('#error').html('Invalid Username or Password !!!');

                  } else {
                    alert('Invalid Username or Password !!!');
                    window.location.href = "/"; 

                  }
                  
                }



              });
            }
            else{
              alert('Please fill all the field !');
            }
          });

       // });

      
       // });

      

    });

       
 </script>

</body>
</html>
